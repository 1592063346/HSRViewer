(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[339],{8053:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[uid]",function(){return i(7165)}])},8186:function(e,t,i){"use strict";i.d(t,{T:function(){return a}});var l=i(5893);let a=(e,t)=>(0,l.jsx)("div",{style:{color:"white",fontSize:e},children:t})},7165:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return D}});var l,a,r,n,s=i(5893),o=i(1163),c=i(8186),d=i(5968),g=i(6226),f=i(2075),u=i(5081),h=i(9356),m=i(1871);let x=e=>{let{text:t,onClick:i}=e;return(0,s.jsx)(h.ZP,{type:"text",onClick:i,style:m.jn,children:(0,s.jsx)("div",{style:{color:"white",fontSize:20},children:t})})};var y=i(7294),p=i(6154);let b="https://raw.githubusercontent.com/Mar-7th/StarRailRes/master",v=e=>{if("object"==typeof e){if(Array.isArray(e))for(let t=0;t<e.length;++t)e[t]=v(e[t]);else for(let i in e)e[i]=v(e[i])}else"string"==typeof e&&e.includes(".png")&&(e=b+"/"+e);return e},w=p.Z.create({baseURL:""});(l=r||(r={}))[l.CORRUPTED_RESPONSE=0]="CORRUPTED_RESPONSE",l[l.UNKNOWN_ERROR=1]="UNKNOWN_ERROR";class S extends Error{toString(){return this.message}valueOf(){return this.message}constructor(e,t){super(),this.type=e,this.message=t}}let I=async(e,t,i,l)=>{let a=await w.request({method:t,url:e,params:l,data:i}).catch(e=>e.response);return null==a?void 0:a.data},j=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l="/api/"+e.toString();return i.lang=t,I(l,"GET",void 0,i)},T=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=await j(e,t);if(!0===i&&(l=await v(l)),l.detail)throw new S(r.UNKNOWN_ERROR,l.detail);return l},R=e=>"string"==typeof e&&/^\d{9}/.test(e);(a=n||(n={})).CHT="cht",a.CHS="cn",a.DE="de",a.EN="en",a.ES="es",a.FR="fr",a.ID="id",a.JP="jp",a.KR="kr",a.PT="pt",a.RU="ru",a.TH="th",a.VI="vi";var _=i(888),H=i(7183),A=i(8524),E=i(894);let O=["","","","rgba(69, 150, 255, 1)","rgba(181, 140, 255, 1)","rgba(255, 199, 112, 1)"],C=["I","II","III","IV","V"],P=[20,30,40,50,60,70,80],W={1001:[500,400],1006:[550,300],1009:[550,350],1102:[360,560],1103:[550,450],1107:[500,200],1203:[520,300],1204:[580,450],1209:[520,300],1211:[520,300],8002:[530,480]},N=e=>W[e]?W[e]:[500,200];var k=i(137);let F=e=>{let{character:t,player:i}=e,l=(0,y.useRef)(null),a=e=>e.toFixed(0),r=e=>(100*e).toFixed(1)+"%",n=(e,t)=>t<4?a(e):r(e),o=(e,t,i,l,a,r,n)=>{if(0!=n){if(e.measureText(t).width<=a)e.fillText(t,i,l);else{let s=0;for(let c=0;c<t.length;++c)if(" "===t[c]){if(e.measureText(t.substring(0,c)).width<=a||0===s)s=c;else break}0===s&&(s=t.length),e.fillText(t.substring(0,s),i,l,a),o(e,t.substring(s+1),i,l+r,a,r,n-1)}}},c=(e,t,i,l,a)=>{e.beginPath(),e.arc(t+l,i+l,l,Math.PI,1.5*Math.PI),e.arc(t+l,i-l,l,.5*Math.PI,Math.PI),e.arc(t-l,i+l,l,1.5*Math.PI,2*Math.PI),e.arc(t-l,i-l,l,0,.5*Math.PI),e.fillStyle=a,e.fill()},d=e=>{let l=document.createElement("a"),a=e.toDataURL("image/png",1);l.href=a,l.download=i.uid+"_"+t.name+".png",l.click()},g=window.devicePixelRatio;return(0,y.useEffect)(()=>{let e=t.element.name,a=t.element.id,s=new Image;s.setAttribute("crossOrigin","anonymous"),s.src=t.portrait;let d=l.current,g=d.getContext("2d");if(g.clearRect(0,0,1400,600),g.fillStyle="rgba(0, 0, 0, 0.1)",g.fillRect(0,0,1400,600),s.onload=()=>{console.log(t.id),g.drawImage(s,N(t.id)[0],N(t.id)[1],1024,1024,0,0,600,600);let e=g.createLinearGradient(0,0,180,0);e.addColorStop(0,"rgba(50, 50, 50, 0.5)"),e.addColorStop(1,"rgba(50, 50, 50, 0)"),g.fillStyle=e,g.fillRect(0,0,180,600);let l=g.createLinearGradient(420,0,600,0);l.addColorStop(0,"rgba(50, 50, 50, 0)"),l.addColorStop(1,"rgba(50, 50, 50, 0.5)"),g.fillStyle=l,g.fillRect(420,0,180,600),g.fillStyle="#FFFFFF",g.font="24px HanYiWenHei-85W",g.fillText(t.name,10,30),g.font="18px HanYiWenHei-85W",g.fillText("Lv. "+t.level+"/"+P[t.promotion],10,60),g.roundRect(0,0,1400,600,20),g.globalCompositeOperation="destination-in",g.fill(),g.globalCompositeOperation="source-over";let a=[];for(let r=0;r<6;++r)a.push(new Image),a[r].setAttribute("crossOrigin","anonymous"),a[r].src=t.rank_icons[r],a[r].onload=()=>{if(g.drawImage(a[r],10,280+50*r,40,40),t.rank<=r){g.beginPath(),g.arc(30,280+50*r+20,20,0,2*Math.PI),g.fillStyle="rgba(50, 50, 50, 0.7)",g.fill();let e=new Image;e.setAttribute("crossOrigin","anonymous"),e.src="data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>lock</title><path d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" /></svg>'),e.onload=()=>{g.drawImage(e,20,290+50*r,20,20)}}};g.font="12px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText(i.uid,10,590);let n=[];for(let o=0;o<4;++o)n.push(new Image),n[o].setAttribute("crossOrigin","anonymous"),n[o].src=t.skills[o].icon,n[o].onload=()=>{g.drawImage(n[o],535,330+65*o,55,55),g.beginPath(),g.arc(562.5,330+65*o+27.5+22,8,0,2*Math.PI),g.fillStyle="rgba(50, 50, 50, 1)",g.fill(),g.fillStyle="rgba(255, 255, 255, 1)",g.font="12px HanYiWenHei-85W",g.fillText(t.skills[o].level,562.5-g.measureText(t.skills[o].level).width/2,330+65*o+27.5+26)}},t.light_cone){let f=new Image;f.setAttribute("crossOrigin","anonymous"),f.src=t.light_cone.preview,f.onload=()=>{g.drawImage(f,618,0,153.6,180);for(let e=0;e<t.light_cone.rarity;++e)c(g,636+12*e,165,7,"rgba(255, 199, 112, 1)")};g.font="22px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",o(g,t.light_cone.name,771.6,40,200,27,4),g.beginPath(),g.arc(781.6,148,15,0,2*Math.PI),g.fillStyle="rgba(30, 30, 30, 1)",g.fill(),g.font="15px",g.fillStyle="rgba(191, 160, 102, 1)",g.fillText(C[t.light_cone.rank-1],781.6-g.measureText(C[t.light_cone.rank-1]).width/2,156),g.font="20px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText("Lv."+t.light_cone.level+"/"+P[t.light_cone.promotion],816.6,156);let u=976.6,h=[];for(let m=0;m<3;++m)h.push(new Image),h[m].setAttribute("crossOrigin","anonymous"),h[m].src=t.light_cone.attributes[m].icon,h[m].onload=()=>{g.drawImage(h[m],u,20+50*m,40,40),g.font="18px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText(t.light_cone.attributes[m].display,u+40,20+50*m+40-15)}}else g.fillStyle="#FFFFFF",g.fillText("No Light Cone.",750,111);let x={};for(let y=0;y<t.attributes.length;++y)x[t.attributes[y].name]={image:new Image,value:t.attributes[y].value},x[t.attributes[y].name].image.src=t.attributes[y].icon,x[t.attributes[y].name].image.setAttribute("crossOrigin","anonymous");for(let p=0;p<t.additions.length;++p)void 0===x[t.additions[p].name]?(x[t.additions[p].name]={image:new Image,value:t.additions[p].value},x[t.additions[p].name].image.src=t.additions[p].icon,x[t.additions[p].name].image.setAttribute("crossOrigin","anonymous")):x[t.additions[p].name].value+=t.additions[p].value;let v=["HP","ATK","DEF","SPD","CRIT Rate","CRIT DMG","Break Effect","Outgoing Healing Boost","Energy Regeneration Rate","Effect Hit Rate","Effect RES",e+" DMG Boost"],w=["MaxHP","Attack","Defence","Speed","CriticalChance","CriticalDamage","BreakUp","HealRatio","EnergyRecovery","StatusProbability","StatusResistance",a+"AddedRatio"];for(let S=0;S<6;++S)void 0===x[v[S]]&&(x[v[S]]={image:new Image,value:0},x[v[S]].image.setAttribute("crossOrigin","anonymous"),x[v[S]].image.src=b+"/icon/property/Icon"+w[S]+".png"),x[v[S]].image.onload=()=>{S%2==0?g.drawImage(x[v[S]].image,618,195+S/2*45,40,40):g.drawImage(x[v[S]].image,838,195+(S-1)/2*45,40,40),g.font="18px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",S%2==0?(g.fillText(n(x[v[S]].value,S),828-g.measureText(n(x[v[S]].value,S)).width,195+S/2*45+25),g.fillText(v[S],658,195+S/2*45+25)):(g.fillText(n(x[v[S]].value,S),1048-g.measureText(n(x[v[S]].value,S)).width,195+(S-1)/2*45+25),g.fillText(v[S],878,195+(S-1)/2*45+25))};for(let I=6;I<v.length;++I)void 0===x[v[I]]&&(x[v[I]]={image:new Image,value:0},x[v[I]].image.setAttribute("crossOrigin","anonymous"),8===I&&(x[v[I]].value=1),x[v[I]].image.src=b+"/icon/property/Icon"+w[I]+".png"),x[v[I]].image.onload=()=>{g.drawImage(x[v[I]].image,618,195+(I-3)*45,40,40),g.font="18px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText(r(x[v[I]].value),1048-g.measureText(r(x[v[I]].value)).width,195+(I-3)*45+25),g.fillText(v[I],658,195+(I-3)*45+25)};let j=[];for(let T=0;T<6;++T)j.push({image:new Image,id:-1}),j[T].image.setAttribute("crossOrigin","anonymous");if(0===t.relics.length)g.fillStyle="#FFFFFF",g.fillText("No Relics.",1170,333);else for(let R=0;R<t.relics.length;++R){let _=R;j[_].id=R,j[_].image.src=t.relics[R].icon,j[_].image.onload=()=>{g.drawImage(j[R].image,1083,20+97*_,90,90);for(let e=0;e<t.relics[R].rarity;++e)c(g,1083,20+97*_+97-20-2*e*7,7,O[t.relics[R].rarity]);g.font="18px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText("Lv. "+t.relics[R].level+"/"+3*t.relics[R].rarity,1178,20+97*_+25)};let H=new Image;H.setAttribute("crossOrigin","anonymous"),H.src=t.relics[R].main_affix.icon,H.onload=()=>{g.drawImage(H,1258,20+97*_,40,40)},g.font="18px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText(t.relics[R].main_affix.display,1298,20+97*_+25);let A=[];for(let E=0;E<t.relics[R].sub_affix.length;++E)A.push(new Image),A[E].setAttribute("crossOrigin","anonymous"),A[E].src=t.relics[R].sub_affix[E].icon,A[E].onload=()=>{E<2?(g.drawImage(A[E],1178+80*E,20+97*_+35,25,25),g.font="14px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText(t.relics[R].sub_affix[E].display,1178+80*E+25,20+97*_+35+18)):(g.drawImage(A[E],1178+(E-2)*80,20+97*_+60,25,25),g.font="14px HanYiWenHei-85W",g.fillStyle="rgba(255, 255, 255, 1)",g.fillText(t.relics[R].sub_affix[E].display,1178+(E-2)*80+25,20+97*_+60+18))}}},[t]),(0,s.jsxs)(f.Z,{direction:"vertical",children:[(0,s.jsx)("canvas",{ref:l,width:1400,height:600,style:{width:1400/g,height:600/g}}),(0,s.jsxs)(f.Z,{children:[(0,s.jsx)(x,{text:"DOWNLOAD",onClick:()=>d(l.current)}),(0,s.jsx)("div",{style:{fontSize:16,color:"rgb(185, 185, 185)"},children:"P.S. Please wait until the image is completely loaded."})]}),(0,s.jsx)(k.Z,{})]})},{Sider:Z}=H.Z,M=e=>{let{data:t}=e,[i,l]=(0,y.useState)(0);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{justify:"center",className:"h5Title",children:(0,s.jsxs)(g.Z,{span:16,style:{color:"white"},children:[(0,s.jsx)(A.C,{size:112,src:t.player.avatar.icon}),(0,s.jsxs)(f.Z,{direction:"vertical",children:[(0,s.jsx)("div",{style:{fontSize:36},children:t.player.nickname}),(0,s.jsx)("div",{style:{fontSize:18,color:"rgb(185, 185, 185)"},children:t.player.signature})]})]})}),(0,s.jsx)(d.Z,{justify:"center",className:"subtitle",children:(0,s.jsx)(g.Z,{span:16,style:{color:"rgb(215, 215, 215)"},children:(0,s.jsxs)(f.Z,{direction:"horizontal",size:36,children:[(0,s.jsxs)("div",{style:{fontSize:20},children:["Trailblaze Level: ",t.player.level]}),(0,s.jsxs)("div",{style:{fontSize:20},children:["Equilibrium Level: ",t.player.world_level]}),(0,s.jsxs)("div",{style:{fontSize:20},children:["Achievements: ",t.player.space_info.achievement_count]})]})})}),(0,s.jsx)(d.Z,{justify:"center",className:"h5Title",children:(0,s.jsx)(g.Z,{span:20,style:{color:"white"},children:t.player.is_display||0===t.characters.length?(0,s.jsxs)(H.Z,{style:{backgroundColor:"rgba(0, 0, 0, 0)"},children:[(0,s.jsx)(Z,{style:{backgroundColor:"rgba(0, 0, 0, 0)"},width:120,children:(0,s.jsx)(E.Z,{defaultSelectedKeys:["0"],mode:"inline",items:(e=>{let t=[];for(let i=0;i<e.length;++i){var a,r,n;t.push((a="0"+i,r=(0,s.jsx)(A.C,{size:64,src:e[i].icon}),n=()=>l(i),{key:a,icon:r,onClick:n}))}return t})(t.characters),style:{backgroundColor:"rgba(0, 0, 0, 0)"}})}),(0,s.jsx)(F,{character:t.characters[i],player:t.player})]}):(0,s.jsx)("div",{style:{fontSize:24,color:"white"},children:"Sorry, this player does not have display characters."})})})]})},z=()=>{let e=(0,o.useRouter)(),[t,i]=(0,y.useState)({}),[l,a]=(0,y.useState)(0);(0,y.useEffect)(()=>{e.isReady&&a(0)},[e]),(0,y.useEffect)(()=>{if(0===l)try{let t=e.query.uid;R(t)?T(t,n.EN,!0).catch(()=>a(2)).then(e=>{e&&(i(e),a(1))}):a(2)}catch(r){a(2)}},[l]);let r=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{justify:"center",className:"h5Title",children:(0,s.jsxs)(g.Z,{span:16,children:[(0,c.T)(40,"Oops! Something went wrong..."),(0,c.T)(20,"Try to check if the UID you entered is valid?")]})}),(0,s.jsx)(d.Z,{justify:"center",className:"h5Title",children:(0,s.jsx)("div",{style:{margin:"auto"},children:(0,s.jsxs)(f.Z,{children:[(0,s.jsx)(x,{text:"BACK",onClick:()=>e.push("/")}),(0,s.jsx)(x,{text:"TRY AGAIN?"})]})})})]}),h=(0,s.jsx)(M,{data:t}),m=(0,s.jsx)(u.Z,{className:"spin",indicator:(0,s.jsx)(_.Z,{style:{fontSize:80,color:"white"},spin:!0})});return(0,s.jsx)(s.Fragment,{children:0===l?m:1===l?h:r})};var D=z}},function(e){e.O(0,[251,774,888,179],function(){return e(e.s=8053)}),_N_E=e.O()}]);